jQuery.fn.kirinlyric=function(j){var l=".kirinlyric";var k=j.farPrev||"far-prev";var c=j.prev||"prev";var i=j.current||"current";var g=j.next||"next";var m=j.farNext||"far-next";var d=$(this);var h=b(j.lrc);var a=$(j.target).html('<span class="kirinlyric blank-row '+k+'"></span><span class="kirinlyric blank-row '+c+'"></span>');var f=[];$.each(h,function(n,o){if(((o.text).indexOf("@"))==0){}else{if(/^raw/.test(o.time)){f.push((o.text).replace(/\[(\d{2}):(\d{2})[:.](\d{2})\]/g,""))}else{f.push('<span class="kirinlyric" data-time="'+o.time+'">'+(o.text).replace(/\[(\d{2}):(\d{2})[:.](\d{2})\]/g,"")+"<br></span>")}}});a.append(f.join("")).append('<span class="kirinlyric blank-row"></span><span class="kirinlyric blank-row"></span>');function e(){var p=d.prop("currentTime");var n=$(l);var o=0;n.removeClass(c).removeClass(i).removeClass(g).removeClass(k).removeClass(m).each(function(z,y){var s=$((n[z-2]));var q=$((n[z-1]));var x=$(y);var u=$((n[z+1]));var w=$((n[z+2]));var r=x.data("time");var t=u.data("time");if(p>r&&typeof t=="undefined"||p<t-0.5){s.addClass(k);q.addClass(c);x.addClass(i);u.addClass(g);w.addClass(m);if(jQuery("#checkbox_auto #enable_lyric").prop("checked")){if(!d.paused){var v=(((jQuery(s).position().top)>0)?(jQuery(s).position().top):(jQuery(x).position().top))-(jQuery(l+"[data-time]").position().top);v=(v>0)?v:0;if(v>o){o=v;jQuery("#lyrics").animate({scrollTop:v},10,"swing")}}}return false}})}setInterval(e,300);function b(o){var p=[];var n=o.split(/\r\n|\r|\n|ã€€/);$.each(n,function(q,t){var s=t.match(/^([^\[]*)\[(\d{2}):(\d{2})[:.](\d{2})\](.*)$/);if(s&&s.length==6){var r=(Number(s[2])*60+Number(s[3]))+Number(s[4])/100;p.push({time:r,text:s[1]+s[5]})}else{p.push({time:"raw"+q,text:t})}});return p}};
